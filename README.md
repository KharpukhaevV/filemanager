# TUI Файловый менеджер

Быстрый, настраиваемый файловый менеджер для терминала, написанный на Go. Просматривайте локальные файлы или на SFTP-сервере с лёгкостью, просматривайте код с подсветкой синтаксиса и управляйте файлами, не покидая терминал.

Этот TUI-файловый менеджер предоставляет двухпанельный макет для интуитивной навигации и предпросмотра файлов, с поддержкой стандартных файловых операций, просмотра архивов и надёжной интеграции с SFTP.

## Возможности

-   **Двухрежимная работа:** Бесшовное переключение между локальной файловой системой и удалённым SFTP-обзором.
-   **Комплексный предпросмотр файлов:**
    -   Подсветка синтаксиса для десятков языков программирования с использованием Chroma.
    -   Автоматическое форматирование для JSON и XML.
    -   Базовый рендеринг для файлов Markdown.
    -   Функция поиска в предпросмотре.
-   **Просмотр архивов:** Изучайте содержимое архивов `.zip`, как если бы это были обычные директории, как локально, так и на удалённых серверах.
-   **Интеграция с SFTP:**
    -   Подключайтесь к SFTP-серверам с помощью интерактивного запроса.
    -   Автоматически сохраняет данные последнего подключения для быстрого переподключения.
    -   Загружайте файлы с удалённого сервера с индикатором прогресса в `~/.filemanager/downloads`.
-   **Эффективная навигация:** Знакомые Vim-подобные сочетания клавиш (`j/k`), быстрая прокрутка и история директорий.
-   **Файловые операции:** Создавайте, переименовывайте, перемещайте и удаляйте файлы и директории как в локальной, так и в удалённой файловых системах.
-   **Настраиваемое темирование:** Легко меняйте цветовую схему приложения, редактируя простой JSON-файл конфигурации.
-   **Иконки Nerd Font:** Визуальная идентификация типов файлов с помощью иконок (требует установки и включения Nerd Font в вашем терминале).
-   **Интеграция с оболочкой:** Опция выхода и изменения текущей директории вашей оболочки на последний посещённый путь.

## Установка

### Требования
- Go 1.24+
- [Nerd Font](https://www.nerdfonts.com/) (опционально, для иконок)

### Шаги

1.  Установите приложение с помощью `go install`:
    ```sh
    go install github.com/KharpukhaevV/filemanager/cmd/fl@latest
    ```
2.  (Опционально, но рекомендуется) Чтобы включить изменение текущей директории оболочки при выходе, добавьте следующую функцию в файл конфигурации вашей оболочки (например, `~/.bashrc`, `~/.zshrc`):
    ```sh
    fl() {
        # Создаём временный файл для хранения выходной директории
        local tempfile
        tempfile=$(mktemp)
        # Гарантируем удаление временного файла при возврате из функции
        trap 'rm -f "$tempfile"' RETURN
        
        # Запускаем файловый менеджер, перенаправляя его stdout во временный файл
        command fl > "$tempfile"
        
        # Если временный файл не пуст, переходим в директорию, которую он содержит
        if [[ -s "$tempfile" ]]; then
            local dir_to_go
            dir_to_go=$(cat "$tempfile")
            cd "$dir_to_go" || return
        fi
    }
    ```
    После добавления функции перезапустите вашу оболочку или выполните source файла конфигурации (например, `source ~/.zshrc`).

3.  Запустите файловый менеджер, набрав `fl` в вашем терминале.

## Сочетания клавиш

### Глобальные
| Клавиша(и)     | Действие                                                |
|----------------|-------------------------------------------------------|
| `q`, `Ctrl+c`  | Выйти из приложения.                                 |
| `Ctrl+o`       | Выйти и изменить текущую директорию оболочки на текущий путь (требует функцию в оболочке). |
| `Ctrl+s`       | Подключиться к новому SFTP-серверу или отключиться от текущего. |

### Панель навигации
| Клавиша(и)     | Действие                                                |
|----------------|-------------------------------------------------------|
| `↑`, `k`         | Переместить курсор вверх.                                       |
| `↓`, `j`         | Переместить курсор вниз.                                     |
| `Ctrl+k`       | Прокрутить вверх на 10 элементов.                                |
| `Ctrl+j`       | Прокрутить вниз на 10 элементов.                              |
| `Ctrl+u`       | Перейти к началу списка файлов.                     |
| `Ctrl+d`       | Перейти к концу списка файлов.                  |
| `Enter`, `l`     | Открыть файл для предпросмотра или войти в директорию/архив. |
| `b`, `h`         | Перейти в родительскую директорию или выйти из архива.  |
| `Space`        | Переключить панель предпросмотра для выбранного файла.        |

### Файловые операции
| Клавиша(и)     | Действие                                                |
|----------------|-------------------------------------------------------|
| `a`            | Создать новый файл или директорию (добавьте `/` для директории). |
| `r`            | Переименовать выбранный файл или директорию.                |
| `m`            | Переместить выбранный файл или директорию.                  |
| `d`            | Удалить выбранный файл или директорию (с подтверждением). |
| `Ctrl+x`       | Загрузить выбранный файл с SFTP-сервера.      |

### Панель предпросмотра
| Клавиша(и)     | Действие                                                |
|----------------|-------------------------------------------------------|
| `esc`, `h`       | Закрыть панель предпросмотра.                               |
| `↑`, `k`         | Прокрутить вверх на одну строку.                                   |
| `↓`, `j`         | Прокрутить вниз на одну строку.                                 |
| `Ctrl+k`       | Прокрутить вверх на 10 строк.                                   |
| `Ctrl+j`       | Прокрутить вниз на 10 строк.                                 |
| `Ctrl+u`       | Перейти к началу файла.                            |
| `Ctrl+d`       | Перейти к концу файла.                         |
| `f`            | Войти в режим поиска внутри предпросмотра.                 |
| `n`            | (В режиме поиска) Перейти к следующему совпадению.              |
| `p`            | (В режиме поиска) Перейти к предыдущему совпадению.          |
| `Enter`        | (В режиме поиска) Выполнить поиск.                  |
| `esc`          | (В режиме поиска) Выйти из режима поиска.                    |

## Конфигурация

При первом запуске приложение создаст директорию конфигурации в `~/.filemanager`.

### Стили

Вы можете настроить внешний вид приложения, отредактировав файл `~/.filemanager/filemanager_styles.json`. Этот файл создаётся со значениями по умолчанию, если он не существует.

Вот пример конфигурации:
```json
{
  "TitleForeground": "#FFFFFF",
  "TitleBackground": "#4A90E2",
  "HeaderForeground": "#FFFFFF",
  "HeaderBackground": "#4A4A4A",
  "SelectedForeground": "#FFFFFF",
  "SelectedBackground": "#6C6C6C",
  "TopLineForeground": "#FFFFFF",
  "TopLineBackground": "#4A4A4A",
  "TopLineInputForeground": "#FFFFFF",
  "TopLineInputBackground": "#4A90E2",
  "BorderForeground": "#6C6C6C"
}
```

### SFTP-подключения

Файл `~/.filemanager/sftp_config.json` хранит хост, пользователя и пароль для последнего успешного SFTP-подключения. Когда вы инициируете новое подключение, вам будет предложено использовать эти сохранённые учётные данные или ввести новые.

### Загрузки

Файлы, загруженные с SFTP-серверов, сохраняются в директории `~/.filemanager/downloads`, организованной в поддиректории по дате (например, `ГОД/МЕСЯЦ/ДЕНЬ/`).
